(defn sqrt [x] (* x x))
(defn tan-cf [x k]
  (def iter (fn [i result]
    (if (= i 0)
       result
       (iter (dec i) (/ (if (= i 1) x (sqrt x)) (- (- (* i 2) 1) result))))))
   (iter k 0))

;; user=> (tan-cf (/ 3.14 4) 1000)
;; 0.9992039901050428
;; user=> (tan-cf 0.0 1000)
;; 0.0
;; user=> (tan-cf 333 1000)
;; -3427638995752907576001311057550598499349304909939362381344986347539261637106407858320714911267096335231439745695143576032296775759889336236478116273028278170018462733862101195021903590044701846140395511734275179379139877809138260419710199112091722763055015752543393196657759989779763649684788459290096495619523171879269459440977340416739335136480179502438279498720191569748945788135133946961313860244998301256332487979809475556596938825817148847287373676136550965398932042989407725498341088597046911094498039523197960092450284009080079916164840532433314904654843879472432902364250022471130569302582515558851506213627030823938773064579045521982047530332835604866670981732752105360413222118268277131286971914036274067996419840489726219042025452391436808839677631292975395358371412165890819708103375084547836037072634436356417884723164237398930482061529607110452210004581119243792610841134056677652682003705987358716998598546962378185087049436275733651303519176528852973419323954849002510857183120280795536882945613595013126073515704692148504290368447693391334758196195313297961138234738436204014876169222401620823366949955141028455122497090636952381115793236711323889655908434715379966092826714050280576585453805033312068044293182320691234961361199922147061965635719306466849540748516936114002983178932245555696051865266795559896877725001685702313017199287638290135885493031805804887265824753939741718657657775133708731381046578096571216109753332896948852870903856398682347597137778665329657536204447823499894410814563411387430956764429993881935228235450458228706369553845757067625478816789823484967873372812300164053448617027390833477689048165817492288901437742738463532970403608189094795335184605860792819648134564339259020299381655931239105904125704849864718216552738617437832093167985184373926793446384292299324194809811424938117688705004658276747817182445030629641132178533983173397834657275267142536038135510505172430761223472461261262772854325385500214352984971615941527776051719152915064167169133891843040026011113525462967540027343616927071429212604197997150122589081957174104527485888604498059346580943448628883876713618226542974337951295691235680875771508858103475897079018563425285451458513938585458955921478350008226360103315440915851859995739107391863912673205411773893345501095109665723097810945335839655520710583134782115492812495797474474905390509138840602273137997474287678147114291534293937756720887285432810989085735191022172326449929629981839997968145742158945559521066790885995145757599203681134975794479621822037194405421198063214217991729355314857515168946761857744048595125/388554709379661183275823886166146788855547631007408130485350219981476631847633254358973882962091392783770978254890447890265450853735883378675999219697036768939108125808147067746836277200820163714333056422617578868323641907870423315678776012443206470491028586915477401777956396199796034196243792896831429771369862318271404746160673626090012725672007462311192571440133433312837717572311617940984658286819527478944748213969474389223671398961517131178712501431759601703021190011782639976245407833236189104767531240522501452525934648828788393376553719509006168483756698587718323891527900499323917414328806359979089426110046518986734501907523898226570321053454701307652281590814595190300374215334004700976113887265956407359633212392242979463706830440589631309954924141027825272193261769432671263314938667084019858556469229487682381684279613635351282219140485849260052744424402859929124520397273593160453882738577894052102900286376239224803034155882392696493188163112752708069605358861891870538718354470904015661019453105169141177653583531225310838025659989597748946106057174487630435602291229980517706422608543328738430031629968624540977084814152856669495528730946214285739664756697746663688062708845049544956156482025359813680158250612627649845955772217143196093164555360585734538846856569148809411054777498397047555158177028010785487310107766711440874868954810844132843624362957495790592085318633840004262263083287138326562215543089345974847631573257258120085656854303017068991650642660038353003567679234483468836569166686159036676803544351404719548908156522069513325723401133238720677564501655495113043854812992145566608061446628230128058042152762117258800708062549443924508350013650074388425113551586684198939023297047439845315810026088817533759654891875356301143584132186318668787159240855865723090134786073381732745738962452519999184387570296134093400716566199321834957043823705285497465277099951517276197434096433804014429656308564572931878196671021980544799290869893314015097945616335888126954976075889070465200481640382347848809532428327333258451799012942252773176849957036435663763153114072934798313148278418497438334506786079595490387965256283099377864875554029829873818256805013042419060313952787663911681771575091991924476963219405699764676369025819239936070081274617949952836619321877474334801507961698137556444994117811254393763522713088489280594562339164655665226758850935834545660444944801744962482345493135512116453624491353070436813088574329843435846692027769683568978026209677190885046167251128777753563781918073732689583062403818914246164494098746189003245954375137134568035562470629

;; yag-san
;; (defn tan-cf [x k]
;;   (defn frac-iter [i result]
;;     (if (= i 0)
;;       result
;;       (frac-iter (dec i) (/ (if (= i 1) x (* x x)) (- (- (* i 2) 1) result)))))
;;   (frac-iter k 0))
;; (def a (fn [x] (+ 1 x)))
;; (tan-cf (/ 3.14 4) 1000)
;; 0.9992039901050428


